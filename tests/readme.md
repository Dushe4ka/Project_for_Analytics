Давайте подробно рассмотрим, как работает программа от загрузки файла до формирования запроса к языковой модели, без использования кода.

Загрузка файла:

Пользователь запускает приложение и видит графический интерфейс с кнопками и полями для ввода.
Когда пользователь нажимает кнопку для загрузки файла, открывается диалоговое окно, где он может выбрать файл на своем компьютере. Программа поддерживает текстовые файлы и PDF-документы.
Выбранный файл загружается: если это PDF, программа извлекает текст из каждой страницы и объединяет его в один текстовый блок. Если это текстовый файл, содержимое файла считывается и также помещается в текстовое поле для редактирования.
Сохранение текста:

После загрузки текста в текстовое поле пользователь может отредактировать его или оставить как есть.
Когда пользователь решает сохранить текст, программа разбивает его на более мелкие части (чанки) с использованием специального алгоритма. Этот алгоритм гарантирует, что каждая часть имеет разумный размер и некоторый перекрывающийся текст с соседними частями, что помогает сохранить контекст.
Эти чанки текста затем сохраняются в векторное хранилище, которое используется для хранения встраиваний (представлений) текста. Если векторное хранилище еще не было инициализировано, оно создается заново; если уже существует, новые чанки добавляются к уже имеющимся.
Формирование запроса:

После того как текст сохранен, пользователь может ввести свой вопрос в специальное поле для ввода запроса.
Когда пользователь нажимает кнопку для отправки запроса, программа проверяет, введен ли текст. Если поле пустое, пользователю показывается предупреждение.
Введенный запрос добавляется в историю запросов, которая хранится в памяти программы. История помогает отслеживать, какие вопросы уже были заданы.
Обработка запроса:

Программа формирует контекст, который включает в себя историю сообщений (вопросы и ответы) и текущий запрос. Это позволяет языковой модели лучше понять, что именно хочет узнать пользователь, учитывая предыдущие вопросы.
Если векторное хранилище инициализировано, программа использует его для поиска наиболее релевантных чанков текста, которые могут помочь в ответе на вопрос. Это осуществляется с помощью механизма извлечения, который находит соответствующие части текста на основе запроса.
Если векторное хранилище не инициализировано, запрос отправляется напрямую в языковую модель, и модель генерирует ответ на основе введенного текста и контекста.
Получение ответа:

После обработки запроса языковой моделью или извлечения информации из векторного хранилища, программа получает ответ.
Ответ отображается в специальном текстовом поле, чтобы пользователь мог его видеть. Также ответ добавляется в историю запросов, чтобы поддерживать последовательность взаимодействия.
Таким образом, программа последовательно обрабатывает загруженные данные, позволяет пользователю задавать вопросы и получать ответы, используя мощность языковой модели и векторного хранилища для извлечения информации.